# –ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ Flux GitOps

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–æ–¥—É–ª—å–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –≥–Ω—É—á–∫–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è Flux GitOps —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö.

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
tf-test-w7/
‚îú‚îÄ‚îÄ main.tf                 # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –∑ —É–º–æ–≤–Ω–∏–º –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ variables.tf            # –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –≤—Å—ñ—Ö –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ vars.tfvars            # –ó–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö
‚îú‚îÄ‚îÄ modules/               # –ö–∞—Ç–∞–ª–æ–≥ –∑ –º–æ–¥—É–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ kind/             # –õ–æ–∫–∞–ª—å–Ω–∏–π Kubernetes –∫–ª–∞—Å—Ç–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ gke/              # Google Kubernetes Engine
‚îÇ   ‚îú‚îÄ‚îÄ tls/              # SSH –∫–ª—é—á—ñ –¥–ª—è Flux
‚îÇ   ‚îú‚îÄ‚îÄ github/           # GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
‚îÇ   ‚îî‚îÄ‚îÄ flux/             # Flux CD bootstrap
‚îî‚îÄ‚îÄ flux-manifests/       # GitOps –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏
```

## üéØ –í–∏–±—ñ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

–ü—Ä–æ–µ–∫—Ç –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–≤—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—É `platform`:

### Kind (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
```hcl
platform = "kind"
```
- –õ–æ–∫–∞–ª—å–Ω–∏–π –∫–ª–∞—Å—Ç–µ—Ä –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
- –ù–µ –ø–æ—Ç—Ä–µ–±—É—î Google Cloud

### GKE
```hcl
platform = "gke"
```
- Production-ready –∫–ª–∞—Å—Ç–µ—Ä
- –ü–æ–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Google Cloud
- –ü–æ—Ç—Ä–µ–±—É—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è GCP

## üì¶ –ú–æ–¥—É–ª—ñ

### 1. Kind Module (`modules/kind/`)
–°—Ç–≤–æ—Ä—é—î –ª–æ–∫–∞–ª—å–Ω–∏–π Kubernetes –∫–ª–∞—Å—Ç–µ—Ä –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é kind.

**–ó–º—ñ–Ω–Ω—ñ:**
- `cluster_name` - –Ω–∞–∑–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: "flux-test")

**–í–∏–≤–æ–¥–∏:**
- `cluster_name` - –Ω–∞–∑–≤–∞ —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞

### 2. GKE Module (`modules/gke/`)
–°—Ç–≤–æ—Ä—é—î Google Kubernetes Engine –∫–ª–∞—Å—Ç–µ—Ä –∑ node pool.

**–ó–º—ñ–Ω–Ω—ñ:**
- `GOOGLE_REGION` - —Ä–µ–≥—ñ–æ–Ω GCP
- `GOOGLE_PROJECT` - ID –ø—Ä–æ–µ–∫—Ç—É GCP
- `GKE_NUM_NODES` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—É–∑–ª—ñ–≤

**–í–∏–≤–æ–¥–∏:**
- `cluster_name` - –Ω–∞–∑–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
- `endpoint` - endpoint –∫–ª–∞—Å—Ç–µ—Ä–∞

### 3. TLS Module (`modules/tls/`)
–ì–µ–Ω–µ—Ä—É—î RSA –∫–ª—é—á—ñ –¥–ª—è SSH –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó Flux.

**–ó–º—ñ–Ω–Ω—ñ:** –ù–µ–º–∞—î

**–í–∏–≤–æ–¥–∏:**
- `private_key` - –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á
- `public_key` - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á

### 4. GitHub Module (`modules/github/`)
–°—Ç–≤–æ—Ä—é—î GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –¥–ª—è GitOps.

**–ó–º—ñ–Ω–Ω—ñ:**
- `github_repository_name` - –Ω–∞–∑–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
- `github_owner` - –≤–ª–∞—Å–Ω–∏–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
- `description` - –æ–ø–∏—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

**–í–∏–≤–æ–¥–∏:**
- `repo_url` - URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

### 5. Flux Module (`modules/flux/`)
–í—Å—Ç–∞–Ω–æ–≤–ª—é—î —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î Flux CD.

**–ó–º—ñ–Ω–Ω—ñ:**
- `cluster_name` - –Ω–∞–∑–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
- `github_owner` - –≤–ª–∞—Å–Ω–∏–∫ GitHub
- `github_repository_name` - –Ω–∞–∑–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
- `flux_namespace` - namespace –¥–ª—è Flux
- `private_key` - –ø—Ä–∏–≤–∞—Ç–Ω–∏–π SSH –∫–ª—é—á
- `public_key` - –ø—É–±–ª—ñ—á–Ω–∏–π SSH –∫–ª—é—á

**–í–∏–≤–æ–¥–∏:**
- `flux_bootstrap_status` - —Å—Ç–∞—Ç—É—Å bootstrap

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –∑ Kind

```bash
# 1. –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
git clone <repository-url>
cd tf-test-w7

# 2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ
cp vars.tfvars.example vars.tfvars
# –í—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ vars.tfvars (platform = "kind")

# 3. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏
tofu init

# 4. –†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏
tofu apply -var-file=vars.tfvars
```

### –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ GKE

```bash
# 1. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ
platform = "gke"
GOOGLE_REGION = "europe-west1"
GOOGLE_PROJECT = "your-project-id"

# 2. –ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è –≤ Google Cloud
gcloud auth login
gcloud config set project your-project-id

# 3. –†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏
tofu apply -var-file=vars.tfvars
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ó–º—ñ–Ω–Ω—ñ –¥–ª—è Kind
```hcl
platform = "kind"
flux_namespace = "flux-system"
github_owner = "your-username"
github_repository_name = "flux-gitops"
```

### –ó–º—ñ–Ω–Ω—ñ –¥–ª—è GKE
```hcl
platform = "gke"
GOOGLE_REGION = "europe-west1"
GOOGLE_PROJECT = "your-project-id"
GKE_NUM_NODES = 3
flux_namespace = "flux-system"
github_owner = "your-username"
github_repository_name = "flux-gitops"
```

## üîÑ Workflow

1. **–í–∏–±—ñ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏** —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—É `platform`
2. **–£–º–æ–≤–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** –∫–ª–∞—Å—Ç–µ—Ä–∞ (kind –∞–±–æ GKE)
3. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è SSH –∫–ª—é—á—ñ–≤** –¥–ª—è Flux
4. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é**
5. **Bootstrap Flux** –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è** GitOps –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤

## üìä –ü–µ—Ä–µ–≤–∞–≥–∏ –º–æ–¥—É–ª—å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

- **–ì–Ω—É—á–∫—ñ—Å—Ç—å:** –õ–µ–≥–∫–æ –ø–µ—Ä–µ–º–∏–∫–∞—Ç–∏—Å—è –º—ñ–∂ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:** –ú–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ (EKS, AKS)
- **–ß–∏—Å—Ç–æ—Ç–∞:** –ö–æ–∂–µ–Ω –º–æ–¥—É–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —Å–≤–æ—é —á–∞—Å—Ç–∏–Ω—É
- **–ü–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –ú–æ–¥—É–ª—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–∫—Ä–µ–º–æ
- **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:** –õ–µ–≥–∫–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –º–æ–¥—É–ª—å –æ–∫—Ä–µ–º–æ

## üõ†Ô∏è –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –º–æ–¥—É–ª—å –≤ `modules/`
2. –î–æ–¥–∞—Ç–∏ —É–º–æ–≤—É –≤ –≥–æ–ª–æ–≤–Ω–∏–π `main.tf`
3. –û–Ω–æ–≤–∏—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Ç–∞ –≤–∏–≤–æ–¥–∏

### –ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è EKS:
```hcl
module "eks" {
  source = "./modules/eks"
  count  = var.platform == "eks" ? 1 : 0
  # ... –∑–º—ñ–Ω–Ω—ñ
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –º–æ–¥—É–ª—ñ–≤

- [Kind Module](modules/kind/README.md)
- [GKE Module](modules/gke/README.md)
- [TLS Module](modules/tls/README.md)
- [GitHub Module](modules/github/README.md)
- [Flux Module](modules/flux/README.md)

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ–∑–≤–æ–ª—è—î:
- –®–≤–∏–¥–∫–æ –ø–µ—Ä–µ–º–∏–∫–∞—Ç–∏—Å—è –º—ñ–∂ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑—Ä–æ–±–ª—è—Ç–∏
- –ú–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –∫–æ–¥ —á–∏—Å—Ç–∏–º —Ç–∞ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∏–º 