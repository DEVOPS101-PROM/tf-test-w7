kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
name: local-cluster
# Configure nodes
nodes:
  - role: control-plane
    image: kindest/node:v1.28.0
    kubeadmConfigPatches:
      - |
        kind: InitConfiguration
        nodeRegistration:
          kubeletExtraArgs:
            node-labels: "ingress-ready=true"
      # extraPortMappings:
      #   - containerPort: 80
      #     hostPort: 8081
      #     protocol: TCP
      #   - containerPort: 443
      #     hostPort: 8443
      #     protocol: TCP
      #   - containerPort: 30000
      #     hostPort: 32000
      #     protocol: TCP
  - role: worker
    image: kindest/node:v1.28.0
    kubeadmConfigPatches:
      - |
        kind: InitConfiguration
        nodeRegistration:
          kubeletExtraArgs:
            node-labels: "ingress-ready=true"
      # extraPortMappings:
      #   - containerPort: 80
      #     hostPort: 8082
      #     protocol: TCP
      #   - containerPort: 9443
      #     hostPort: 443
      #     protocol: TCP
      #   - containerPort: 30000
      #     hostPort: 33000
      #     protocol: TCP
      # - role: worker
      #   image: kindest/node:v1.28.0
      #   kubeadmConfigPatches:
      #     - |
      #       kind: InitConfiguration
      #       nodeRegistration:
      #         kubeletExtraArgs:
      #           node-labels: "ingress-ready=true"
      #   extraPortMappings:
      #     - containerPort: 80
      #       hostPort: 80
      #       protocol: TCP
      #     - containerPort: 443
      #       hostPort: 443
      #       protocol: TCP
      #     - containerPort: 30000
      #       hostPort: 30000
      #       protocol: TCP
# Networking configuration
networking:
  # apiServerAddress: "0.0.0.0"
  apiServerPort: 6443
  podSubnet: "10.244.0.0/16"
  serviceSubnet: "10.96.0.0/12"
  disableDefaultCNI: false
# Feature gates for modern Kubernetes features
featureGates:
  IPv6DualStack: false
  ServiceAccountIssuerDiscovery: true
# Runtime configuration
runtimeConfig:
  "api/alpha": "true"
  "api/beta": "true"
